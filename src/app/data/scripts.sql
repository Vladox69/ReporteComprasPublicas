/* Vista para el api*/
create or replace view VISTAPROCESOS as
select  rownum as ID, A.INTRP_FECHA_PUBLICACION,B.INTPRO_DESCRIPCION,B.INTPRO_ABREV,A.INTRP_NUMEROPROCESO,A.INTRP_CODIGOPROCESO,A.INTRP_DETALLE,
        D.INTRES_DETALLE,A.INTRP_NUMOFICIO,A.INTRP_NUMCONTRATO,A.INTRP_VALORCONT,
        C.MA_CONT_RAZON_SOCIAL,E.CONTRAF_NUMERO_CONTRATO,E.CONTRAF_VALOR_CONTRATO,F.INTDEP_CODIGO,F.INTDEP_DESCRIPCION,A.INTRP_ANIO
 from
 INTRANET_RESULPROCESO A
 LEFT JOIN CONTRATISTAS C
 ON A.MA_CONT_COD = C.MA_CONT_COD
 JOIN INTRANET_PROCESO B
 ON A.INTPR_CODIGO =  B.INTPR_CODIGO
 LEFT JOIN INTRANET_RESOLUCION D
 ON A.INTRES_CODIGO = D.INTRES_CODIGO
 LEFT JOIN LIQUIDACIONES.DISCON_CONT_CONTRATOF E
 ON A.INTRP_CODIGO = E.INTRP_CODIGO
 LEFT JOIN INTRANET_DEPARTAMENTO F
 on F.INTDEP_CODIGO = E.DEPAR_ID
 ORDER BY A.INTRP_NUMEROPROCESO


 /*nueva vista*/
 select  rownum as ID, A.INTRP_FECHA_PUBLICACION,B.INTPRO_DESCRIPCION,B.INTPRO_ABREV,A.INTRP_NUMEROPROCESO,A.INTRP_CODIGOPROCESO,A.INTRP_DETALLE,
        D.INTRES_DETALLE,A.INTRP_NUMOFICIO,A.INTRP_NUMCONTRATO,A.INTRP_VALORCONT,
        C.MA_CONT_RAZON_SOCIAL,E.CONTRAF_NUMERO_CONTRATO,E.CONTRAF_VALOR_CONTRATO,F.INTDEP_CODIGO,F.INTDEP_DESCRIPCION
 from
 INTRANET_RESULPROCESO A
 INNER JOIN CONTRATISTAS C ON A.MA_CONT_COD = C.MA_CONT_COD
 INNER JOIN INTRANET_PROCESO B ON A.INTPR_CODIGO =  B.INTPR_CODIGO
 INNER JOIN INTRANET_RESOLUCION D ON A.INTRES_CODIGO = D.INTRES_CODIGO
 INNER JOIN LIQUIDACIONES.DISCON_CONT_CONTRATOF E ON A.INTRP_CODIGO = E.INTRP_CODIGO
 INNER JOIN INTRANET_DEPARTAMENTO F on F.INTDEP_CODIGO = E.DEPAR_ID
 ORDER BY A.INTRP_NUMEROPROCESO

/* Select para buscar por fechas las resoluciones de los procesos*/
select  rownum as ID, A.INTRP_FECHA_PUBLICACION,B.INTPRO_DESCRIPCION,B.INTPRO_ABREV,A.INTRP_NUMEROPROCESO,A.INTRP_CODIGOPROCESO,A.INTRP_DETALLE,
        D.INTRES_DETALLE,A.INTRP_NUMOFICIO,A.INTRP_NUMCONTRATO,A.INTRP_VALORCONT,
        C.MA_CONT_RAZON_SOCIAL,E.CONTRAF_NUMERO_CONTRATO,E.CONTRAF_VALOR_CONTRATO,F.INTDEP_CODIGO,F.INTDEP_DESCRIPCION
 from
      INTRANET_RESULPROCESO A

 LEFT JOIN CONTRATISTAS C
 ON A.MA_CONT_COD = C.MA_CONT_COD
 JOIN INTRANET_PROCESO B
 ON A.INTPR_CODIGO =  B.INTPR_CODIGO
 LEFT JOIN INTRANET_RESOLUCION D
 ON A.INTRES_CODIGO = D.INTRES_CODIGO
 LEFT JOIN LIQUIDACIONES.DISCON_CONT_CONTRATOF E
 ON A.INTRP_CODIGO = E.INTRP_CODIGO
 LEFT JOIN INTRANET_DEPARTAMENTO F
 on F.INTDEP_CODIGO = E.DEPAR_ID
WHERE A.INTRP_FECHA_PUBLICACION > TO_DATE('2019-01-01', 'YYYY-MM-DD') AND A.INTRP_FECHA_PUBLICACION < TO_DATE('2019-12-31', 'YYYY-MM-DD')

/*Buscar liquidaciones que no tengan asignado departamentos*/

